<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.team.supplychain.controllers.AdminDashboardController"
            prefHeight="700.0" prefWidth="1400.0"
            stylesheets="@../css/styles.css, @../css/dashboard-admin.css">

    <!-- TOP: Admin Header Section -->
    <top>
        <HBox styleClass="top-bar-modern" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>

            <VBox spacing="2">
                <Label text="System Administration Hub" styleClass="app-title-modern">
                    <font>
                        <Font name="System Bold" size="22.0" />
                    </font>
                </Label>
                <Label text="Monitor and manage the entire system" styleClass="app-subtitle">
                    <font>
                        <Font size="12.0" />
                    </font>
                </Label>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- Search Bar -->
            <HBox alignment="CENTER" styleClass="search-container" spacing="10">
                <Label text="ðŸ”" styleClass="search-icon">
                    <font>
                        <Font size="16.0" />
                    </font>
                </Label>
                <TextField promptText="Search..." styleClass="search-field" prefWidth="200"/>
            </HBox>

            <!-- User Profile Area -->
            <HBox alignment="CENTER" spacing="15">
                <!-- Notification Bell -->
                <Button fx:id="notificationsButton" text="ðŸ””" styleClass="notification-icon" onAction="#handleNotifications">
                    <font>
                        <Font size="18.0" />
                    </font>
                </Button>

                <!-- User Info -->
                <VBox alignment="CENTER_RIGHT" spacing="3">
                    <Label fx:id="currentUserLabel" text="Welcome, Admin!" styleClass="welcome-text-modern">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Label>
                    <Label text="Role: Administrator" styleClass="role-text-modern">
                        <font>
                            <Font size="12.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- User Avatar -->
                <StackPane styleClass="user-avatar">
                    <Label text="ðŸ‘¤" styleClass="avatar-icon">
                        <font>
                            <Font size="20.0" />
                        </font>
                    </Label>
                </StackPane>

                <Button fx:id="logoutButton" text="Logout" styleClass="logout-button-modern"
                        onAction="#handleLogout">
                    <font>
                        <Font size="13.0" />
                    </font>
                </Button>
            </HBox>
        </HBox>
    </top>

    <!-- LEFT: Admin Sidebar Menu -->
    <left>
        <VBox styleClass="sidebar-modern" spacing="8" prefWidth="280">
            <padding>
                <Insets top="25" right="15" bottom="25" left="15"/>
            </padding>

            <!-- Logo Section -->
            <VBox alignment="CENTER" spacing="10" styleClass="logo-section">
                <padding>
                    <Insets bottom="20"/>
                </padding>
                <Label text="âš™ï¸" styleClass="logo-icon">
                    <font>
                        <Font size="40.0" />
                    </font>
                </Label>
                <Label text="SCMS Admin" styleClass="logo-text">
                    <font>
                        <Font name="System Bold" size="16.0" />
                    </font>
                </Label>
            </VBox>

            <Separator styleClass="menu-separator"/>

            <Label text="NAVIGATION" styleClass="menu-header-modern">
                <font>
                    <Font name="System Bold" size="11.0" />
                </font>
                <VBox.margin>
                    <Insets top="15" bottom="10"/>
                </VBox.margin>
            </Label>

            <!-- Menu Buttons -->
            <Button text="  Dashboard" styleClass="menu-button-modern" onAction="#handleDashboard"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="ðŸ " styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Button text="  User Management" styleClass="menu-button-modern" onAction="#handleManageUsers"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="ðŸ‘¥" styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Button text="  System Settings" styleClass="menu-button-modern" onAction="#handleSystemSettings"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="âš™ï¸" styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Button text="  Security &amp; Access" styleClass="menu-button-modern" onAction="#handleSecurity"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="ðŸ”’" styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Button text="  Audit Logs" styleClass="menu-button-modern" onAction="#handleAuditLogs"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="ðŸ“‹" styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Separator styleClass="menu-separator">
                <VBox.margin>
                    <Insets top="10" bottom="10"/>
                </VBox.margin>
            </Separator>

            <Label text="ANALYTICS" styleClass="menu-header-modern">
                <font>
                    <Font name="System Bold" size="11.0" />
                </font>
                <VBox.margin>
                    <Insets bottom="10"/>
                </VBox.margin>
            </Label>

            <Button text="  Reports &amp; Analytics" styleClass="menu-button-modern" onAction="#handleReports"
                    maxWidth="Infinity" graphicTextGap="15">
                <graphic>
                    <Label text="ðŸ“Š" styleClass="menu-icon">
                        <font>
                            <Font size="18.0" />
                        </font>
                    </Label>
                </graphic>
                <font>
                    <Font size="14.0" />
                </font>
            </Button>

            <Region VBox.vgrow="ALWAYS"/>

            <!-- System Summary Card -->
            <VBox styleClass="user-info-card" spacing="10">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="System Summary" styleClass="user-info-email">
                    <font>
                        <Font name="System Bold" size="11.0" />
                    </font>
                </Label>
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="âœ“" styleClass="user-status">
                        <font>
                            <Font size="12.0" />
                        </font>
                    </Label>
                    <Label text="All Systems Operational" styleClass="user-status">
                        <font>
                            <Font size="10.0" />
                        </font>
                    </Label>
                </HBox>
            </VBox>
        </VBox>
    </left>

    <!-- CENTER: Main Admin Content -->
    <center>
        <ScrollPane fx:id="centerScrollPane" fitToWidth="true" fitToHeight="true" styleClass="content-scroll">
            <VBox spacing="30" styleClass="content-area-modern">
                <padding>
                    <Insets top="30" right="30" bottom="30" left="30"/>
                </padding>

                <!-- Welcome Section -->
                <VBox spacing="10">
                    <Label text="Admin Dashboard" styleClass="welcome-message-modern">
                        <font>
                            <Font name="System Bold" size="28.0" />
                        </font>
                    </Label>
                    <Label text="System-wide oversight and administration" styleClass="subtitle-modern">
                        <font>
                            <Font size="15.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- ROW 1: System Metrics -->
                <HBox spacing="20" alignment="CENTER">
                    <!-- System Health Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="System Health" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-green">
                                <Label text="âœ“" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="systemHealthLabel" text="OK" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="All services running" styleClass="stat-change-positive">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Active Users Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="Active Users" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-blue">
                                <Label text="ðŸ‘¥" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="activeUsersLabel" text="24" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="Currently logged in" styleClass="stat-change-positive">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Total Inventory Items Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="Total Inventory Items" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-purple">
                                <Label text="ðŸ“¦" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="totalItemsLabel" text="342" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="Items in database" styleClass="stat-change-positive">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                    </VBox>
                </HBox>

                <!-- ROW 2: Alert Cards -->
                <HBox spacing="20" alignment="CENTER">
                    <!-- Low Stock Alerts -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="Low Stock Alerts" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-orange">
                                <Label text="âš ï¸" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="lowStockCountLabel" text="5" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="Items need restocking" styleClass="stat-change-negative">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                        <Button text="View Details" styleClass="action-button-secondary" onAction="#handleViewLowStock">
                            <font>
                                <Font size="12.0" />
                            </font>
                        </Button>
                    </VBox>

                    <!-- Security Incidents -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="Security Incidents" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-orange">
                                <Label text="ðŸ”’" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="securityIncidentsLabel" text="2" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="Failed login attempts" styleClass="stat-change-negative">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                        <Button text="Review Security" styleClass="action-button-secondary" onAction="#handleReviewSecurity">
                            <font>
                                <Font size="12.0" />
                            </font>
                        </Button>
                    </VBox>

                    <!-- Pending Tasks -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="30" bottom="25" left="30"/>
                        </padding>
                        <Label text="Pending Admin Tasks" styleClass="stat-label-modern">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <VBox styleClass="stat-icon-container stat-icon-blue">
                                <Label text="ðŸ“" styleClass="stat-icon-modern">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                            </VBox>
                            <VBox spacing="5">
                                <Label fx:id="pendingTasksLabel" text="8" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="32.0" />
                                    </font>
                                </Label>
                                <Label text="Awaiting action" styleClass="stat-change-positive">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                        <Button text="View Tasks" styleClass="action-button-secondary" onAction="#handleViewTasks">
                            <font>
                                <Font size="12.0" />
                            </font>
                        </Button>
                    </VBox>
                </HBox>

                <!-- ROW 3: Charts and Critical Alerts -->
                <HBox spacing="20" alignment="TOP_CENTER">
                    <!-- Inventory Value Trend Chart -->
                    <VBox styleClass="stat-card-modern" spacing="15" HBox.hgrow="ALWAYS" prefWidth="550">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>
                        <Label text="Inventory Value Trend" styleClass="section-title">
                            <font>
                                <Font name="System Bold" size="18.0" />
                            </font>
                        </Label>
                        <LineChart fx:id="inventoryTrendChart" legendVisible="false" animated="true">
                            <xAxis>
                                <CategoryAxis label="Date" side="BOTTOM"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Value (SAR)" side="LEFT"/>
                            </yAxis>
                        </LineChart>
                    </VBox>

                    <!-- Critical Alerts Panel -->
                    <VBox styleClass="stat-card-modern" spacing="15" prefWidth="400">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>
                        <Label text="Critical Alerts" styleClass="section-title">
                            <font>
                                <Font name="System Bold" size="18.0" />
                            </font>
                        </Label>

                        <VBox fx:id="criticalAlertsContainer" spacing="12" styleClass="activity-list">
                            <!-- Alert Item 1 -->
                            <HBox styleClass="activity-item, activity-item-warning" spacing="12" alignment="TOP_LEFT">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="âš ï¸" styleClass="activity-icon"/>
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="Database Backup Needed" styleClass="activity-title"/>
                                    <Label text="Last backup was 7 days ago" styleClass="activity-description"/>
                                    <Label text="2 hours ago" styleClass="activity-timestamp"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 2 -->
                            <HBox styleClass="activity-item, activity-item-info" spacing="12" alignment="TOP_LEFT">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸ”’" styleClass="activity-icon"/>
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="Failed Login Attempt" styleClass="activity-title"/>
                                    <Label text="Unknown user from IP 192.168.1.105" styleClass="activity-description"/>
                                    <Label text="3 hours ago" styleClass="activity-timestamp"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 3 -->
                            <HBox styleClass="activity-item, activity-item-success" spacing="12" alignment="TOP_LEFT">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="âœ…" styleClass="activity-icon"/>
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="System Update Completed" styleClass="activity-title"/>
                                    <Label text="Version 1.0.1 installed successfully" styleClass="activity-description"/>
                                    <Label text="5 hours ago" styleClass="activity-timestamp"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 4 -->
                            <HBox styleClass="activity-item, activity-item-info" spacing="12" alignment="TOP_LEFT">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸ“Š" styleClass="activity-icon"/>
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="New User Registered" styleClass="activity-title"/>
                                    <Label text="John Doe added as Manager" styleClass="activity-description"/>
                                    <Label text="6 hours ago" styleClass="activity-timestamp"/>
                                </VBox>
                            </HBox>
                        </VBox>

                        <Button text="View All Alerts" styleClass="action-button-primary" onAction="#handleViewAllAlerts">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Button>
                    </VBox>
                </HBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- BOTTOM: Status Bar -->
    <bottom>
        <HBox styleClass="status-bar-modern" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="12" right="30" bottom="12" left="30"/>
            </padding>

            <HBox alignment="CENTER" spacing="8">
                <Label text="â—" styleClass="status-indicator">
                    <font>
                        <Font size="12.0" />
                    </font>
                </Label>
                <Label text="System Online" styleClass="status-text-modern">
                    <font>
                        <Font size="12.0" />
                    </font>
                </Label>
            </HBox>

            <Separator orientation="VERTICAL"/>

            <Label text="Database: Connected" styleClass="status-text-modern">
                <font>
                    <Font size="11.0" />
                </font>
            </Label>

            <Region HBox.hgrow="ALWAYS"/>

            <Label text="Version 1.0" styleClass="version-text">
                <font>
                    <Font size="11.0" />
                </font>
            </Label>

            <Separator orientation="VERTICAL"/>

            <Label text="Â© 2025 Supply Chain Management System" styleClass="copyright-text-modern">
                <font>
                    <Font size="10.0" />
                </font>
            </Label>
        </HBox>
    </bottom>

</BorderPane>
