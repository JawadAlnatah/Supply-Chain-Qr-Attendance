<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.team.supplychain.controllers.EmployeeRequisitionsViewController"
      spacing="30" stylesheets="@../css/styles.css, @../css/dashboard-employee.css">
    <padding>
        <Insets top="35" right="35" bottom="35" left="35"/>
    </padding>

    <!-- Page Header -->
    <VBox spacing="8">
        <Label text="My Requisitions" styleClass="page-title">
            <font>
                <Font name="System Bold" size="28"/>
            </font>
        </Label>
        <Label text="View and manage your purchase requisition requests" styleClass="page-subtitle" textFill="#808080">
            <font>
                <Font size="14"/>
            </font>
        </Label>
    </VBox>

    <!-- Summary Cards -->
    <GridPane hgap="20" vgap="20">
        <columnConstraints>
            <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
            <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
            <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
            <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
        </columnConstraints>

        <!-- Total Requests Card -->
        <VBox styleClass="stat-card-modern" spacing="12" GridPane.columnIndex="0">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-blue" prefWidth="45" prefHeight="45">
                    <Label text="ðŸ“‹" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Total Requests" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="totalRequestsValue" text="12" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>

        <!-- Pending Card -->
        <VBox styleClass="stat-card-modern" spacing="12" GridPane.columnIndex="1">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-orange" prefWidth="45" prefHeight="45">
                    <Label text="â³" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Pending" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="pendingValue" text="3" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>

        <!-- Approved Card -->
        <VBox styleClass="stat-card-modern" spacing="12" GridPane.columnIndex="2">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-green" prefWidth="45" prefHeight="45">
                    <Label text="âœ“" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Approved" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="approvedValue" text="8" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>

        <!-- Rejected Card -->
        <VBox styleClass="stat-card-modern" spacing="12" GridPane.columnIndex="3">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-red" prefWidth="45" prefHeight="45">
                    <Label text="âœ—" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Rejected" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="rejectedValue" text="1" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>
    </GridPane>

    <!-- Filters and View Toggle Section -->
    <VBox spacing="20" styleClass="content-card-modern">
        <padding>
            <Insets top="25" right="25" bottom="25" left="25"/>
        </padding>

        <!-- Filter Row -->
        <HBox spacing="15" alignment="CENTER_LEFT">
            <!-- Search Box -->
            <TextField fx:id="searchField" promptText="Search requisitions..." prefWidth="250" styleClass="modern-textfield">
                <font>
                    <Font size="13"/>
                </font>
            </TextField>

            <!-- Status Filter -->
            <VBox spacing="5">
                <Label text="Status" textFill="#808080">
                    <font>
                        <Font size="11"/>
                    </font>
                </Label>
                <ComboBox fx:id="statusFilter" prefWidth="140" styleClass="modern-combobox"/>
            </VBox>

            <!-- Date Filter -->
            <VBox spacing="5">
                <Label text="Period" textFill="#808080">
                    <font>
                        <Font size="11"/>
                    </font>
                </Label>
                <ComboBox fx:id="dateFilter" prefWidth="140" styleClass="modern-combobox"/>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- View Toggle Buttons -->
            <HBox spacing="10">
                <Button fx:id="cardViewButton" text="Card View" styleClass="action-button-primary" onAction="#handleCardView">
                    <font>
                        <Font size="13"/>
                    </font>
                    <padding>
                        <Insets top="10" right="20" bottom="10" left="20"/>
                    </padding>
                </Button>
                <Button fx:id="tableViewButton" text="Table View" styleClass="action-button-secondary" onAction="#handleTableView">
                    <font>
                        <Font size="13"/>
                    </font>
                    <padding>
                        <Insets top="10" right="20" bottom="10" left="20"/>
                    </padding>
                </Button>
            </HBox>
        </HBox>

        <!-- Total Count Label -->
        <Label fx:id="totalCountLabel" text="Total: 0 requisitions" textFill="#808080" style="-fx-font-size: 13px; -fx-font-weight: 500;"/>

        <!-- View Container (StackPane for toggling) -->
        <StackPane>
            <!-- Card View -->
            <ScrollPane fx:id="cardViewPane" fitToWidth="true" styleClass="transparent-scrollpane">
                <VBox fx:id="requisitionsContainer" spacing="12">
                    <!-- Requisitions will be populated dynamically from database -->
                    <!-- Requisition 1 - Pending -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-012" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="Office Supplies" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="5 items â€¢ Requested on Nov 28, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="PENDING" styleClass="po-status-pending" style="-fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition 2 - Approved -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-011" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="IT Equipment" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="3 items â€¢ Requested on Nov 25, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="APPROVED" styleClass="po-status-shipped" style="-fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition 3 - Pending -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-010" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="Safety Equipment" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="8 items â€¢ Requested on Nov 22, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="PENDING" styleClass="po-status-pending" style="-fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition 4 - Approved -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-009" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="Maintenance Tools" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="12 items â€¢ Requested on Nov 18, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="APPROVED" styleClass="po-status-shipped" style="-fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition 5 - Rejected -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-008" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="Furniture" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="4 items â€¢ Requested on Nov 15, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="REJECTED" style="-fx-background-color: rgba(229,57,53,0.15); -fx-text-fill: #e53935; -fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition 6 - Approved -->
                    <HBox styleClass="po-item" spacing="20" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="15" right="20" bottom="15" left="20"/>
                        </padding>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="REQ-2024-007" styleClass="po-number">
                                    <font>
                                        <Font name="System Bold" size="13.0"/>
                                    </font>
                                </Label>
                                <Label text="â€¢" styleClass="po-separator"/>
                                <Label text="Cleaning Supplies" styleClass="po-supplier"/>
                            </HBox>
                            <Label text="15 items â€¢ Requested on Nov 10, 2024" styleClass="po-items">
                                <font>
                                    <Font size="11.0"/>
                                </font>
                            </Label>
                        </VBox>
                        <Label text="APPROVED" styleClass="po-status-shipped" style="-fx-padding: 6 12 6 12; -fx-background-radius: 15;">
                            <font>
                                <Font name="System Bold" size="10.0"/>
                            </font>
                        </Label>
                        <Button text="View" styleClass="action-button-secondary">
                            <font>
                                <Font size="11.0"/>
                            </font>
                        </Button>
                    </HBox>
                </VBox>
            </ScrollPane>

            <!-- Table View (Initially Hidden) -->
            <VBox fx:id="tableViewPane" visible="false" managed="false">
                <TableView fx:id="requisitionsTable" styleClass="modern-table">
                    <columns>
                        <TableColumn fx:id="reqIdColumn" text="Req ID" prefWidth="120" style="-fx-alignment: CENTER-LEFT;"/>
                        <TableColumn fx:id="categoryColumn" text="Category" prefWidth="150" style="-fx-alignment: CENTER-LEFT;"/>
                        <TableColumn fx:id="itemsColumn" text="Items" prefWidth="80" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="dateRequestedColumn" text="Date Requested" prefWidth="180" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="statusColumn" text="Status" prefWidth="120" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="reviewerColumn" text="Reviewer" prefWidth="150" style="-fx-alignment: CENTER-LEFT;"/>
                    </columns>
                    <placeholder>
                        <Label text="No requisitions found" textFill="#bdc3c7">
                            <font>
                                <Font size="14"/>
                            </font>
                        </Label>
                    </placeholder>
                </TableView>
            </VBox>
        </StackPane>
    </VBox>

</VBox>
