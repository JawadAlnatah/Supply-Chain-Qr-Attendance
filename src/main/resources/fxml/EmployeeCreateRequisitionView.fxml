<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<ScrollPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.team.supplychain.controllers.EmployeeCreateRequisitionViewController"
            fitToWidth="true"
            style="-fx-background-color: #f8f9fa;">

<VBox spacing="30"
      style="-fx-background-color: #f8f9fa;">

    <padding>
        <Insets top="35" right="35" bottom="35" left="35"/>
    </padding>

    <!-- Page Header -->
    <VBox spacing="8">
        <Label text="Create New Requisition" styleClass="page-title">
            <font>
                <Font name="System Bold" size="28"/>
            </font>
            <style>
                -fx-text-fill: #2c3e50;
            </style>
        </Label>
        <Label text="Request items from supplier for your department" styleClass="page-subtitle">
            <font>
                <Font size="14"/>
            </font>
            <style>
                -fx-text-fill: #757575;
            </style>
        </Label>
    </VBox>

    <!-- Main Form Section - 2 Column Layout -->
    <GridPane hgap="20" vgap="20">
        <columnConstraints>
            <ColumnConstraints percentWidth="60" minWidth="400"/>
            <ColumnConstraints percentWidth="40" minWidth="300"/>
        </columnConstraints>

        <!-- LEFT COLUMN - Request Details Card -->
        <VBox spacing="20" GridPane.columnIndex="0" GridPane.rowIndex="0">

            <!-- Request Details Card -->
            <VBox spacing="20" styleClass="content-card-modern">
                <padding>
                    <Insets top="25" right="25" bottom="25" left="25"/>
                </padding>
                <style>
                    -fx-background-color: white;
                    -fx-background-radius: 15;
                    -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.08), 12, 0, 0, 3);
                </style>

                <Label text="Request Details">
                    <font>
                        <Font name="System Bold" size="16"/>
                    </font>
                    <style>
                        -fx-text-fill: #2c3e50;
                    </style>
                </Label>

                <!-- Supplier -->
                <VBox spacing="8">
                    <Label text="Supplier *">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                        <style>
                            -fx-text-fill: #424242;
                        </style>
                    </Label>
                    <ComboBox fx:id="supplierCombo"
                             promptText="Select supplier"
                             styleClass="modern-combobox"
                             maxWidth="Infinity">
                        <style>
                            -fx-background-color: #ffffff;
                            -fx-background-radius: 12;
                            -fx-border-color: #d1d5da;
                            -fx-border-width: 1.5px;
                            -fx-border-radius: 12;
                            -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0.0, 0, 2);
                        </style>
                    </ComboBox>
                </VBox>

                <!-- Category -->
                <VBox spacing="8">
                    <Label text="Category *">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                        <style>
                            -fx-text-fill: #424242;
                        </style>
                    </Label>
                    <ComboBox fx:id="categoryCombo"
                             promptText="Select category"
                             styleClass="modern-combobox"
                             maxWidth="Infinity">
                        <style>
                            -fx-background-color: #ffffff;
                            -fx-background-radius: 12;
                            -fx-border-color: #d1d5da;
                            -fx-border-width: 1.5px;
                            -fx-border-radius: 12;
                            -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0.0, 0, 2);
                        </style>
                    </ComboBox>
                </VBox>

                <!-- Priority -->
                <VBox spacing="8">
                    <Label text="Priority *">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                        <style>
                            -fx-text-fill: #424242;
                        </style>
                    </Label>
                    <ComboBox fx:id="priorityCombo"
                             promptText="Select priority level"
                             styleClass="modern-combobox"
                             maxWidth="Infinity">
                        <style>
                            -fx-background-color: #ffffff;
                            -fx-background-radius: 12;
                            -fx-border-color: #d1d5da;
                            -fx-border-width: 1.5px;
                            -fx-border-radius: 12;
                            -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0.0, 0, 2);
                        </style>
                    </ComboBox>
                </VBox>

                <!-- Department -->
                <VBox spacing="8">
                    <Label text="Department *">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                        <style>
                            -fx-text-fill: #424242;
                        </style>
                    </Label>
                    <ComboBox fx:id="departmentCombo"
                             promptText="Select department"
                             styleClass="modern-combobox"
                             maxWidth="Infinity">
                        <style>
                            -fx-background-color: #ffffff;
                            -fx-background-radius: 12;
                            -fx-border-color: #d1d5da;
                            -fx-border-width: 1.5px;
                            -fx-border-radius: 12;
                            -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0.0, 0, 2);
                        </style>
                    </ComboBox>
                </VBox>

                <!-- Justification -->
                <VBox spacing="8">
                    <Label text="Justification / Notes *">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                        <style>
                            -fx-text-fill: #424242;
                        </style>
                    </Label>
                    <TextArea fx:id="justificationArea"
                             promptText="Explain why these items are needed..."
                             styleClass="modern-textarea"
                             wrapText="true"
                             prefRowCount="5">
                        <style>
                            -fx-background-color: #ffffff;
                            -fx-background-radius: 12;
                            -fx-border-color: #d1d5da;
                            -fx-border-width: 1.5px;
                            -fx-border-radius: 12;
                            -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0.0, 0, 2);
                        </style>
                    </TextArea>
                    <Label text="* Required fields">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                </VBox>
            </VBox>

        </VBox>

        <!-- RIGHT COLUMN - Summary Card -->
        <VBox spacing="20" GridPane.columnIndex="1" GridPane.rowIndex="0">

            <!-- Summary Card -->
            <VBox spacing="15" styleClass="stat-card-modern">
                <padding>
                    <Insets top="20" right="20" bottom="20" left="20"/>
                </padding>
                <style>
                    -fx-background-color: white;
                    -fx-background-radius: 15;
                    -fx-border-color: #e0e0e0;
                    -fx-border-width: 1;
                    -fx-border-radius: 15;
                    -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.08), 12, 0, 0, 3);
                </style>

                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Summary">
                        <font>
                            <Font name="System Bold" size="16"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label text="DRAFT">
                        <padding>
                            <Insets top="6" right="12" bottom="6" left="12"/>
                        </padding>
                        <font>
                            <Font name="System Bold" size="10"/>
                        </font>
                        <style>
                            -fx-background-color: rgba(67,160,71,0.15);
                            -fx-text-fill: #43a047;
                            -fx-background-radius: 15;
                        </style>
                    </Label>
                </HBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Requisition ID -->
                <VBox spacing="5">
                    <Label text="Requisition ID">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="requisitionIdLabel" text="REQ-001">
                        <font>
                            <Font name="System Bold" size="20"/>
                        </font>
                        <style>
                            -fx-text-fill: #43a047;
                        </style>
                    </Label>
                </VBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Supplier -->
                <VBox spacing="5">
                    <Label text="Supplier">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="supplierNameLabel" text="Not selected">
                        <font>
                            <Font name="System Bold" size="13"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                </VBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Total Items -->
                <VBox spacing="5">
                    <Label text="Total Items">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="totalItemsLabel" text="0">
                        <font>
                            <Font name="System Bold" size="16"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                </VBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Total Amount -->
                <VBox spacing="5">
                    <Label text="Total Amount">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="totalAmountLabel" text="0.00">
                        <font>
                            <Font name="System Bold" size="18"/>
                        </font>
                        <style>
                            -fx-text-fill: #43a047;
                        </style>
                    </Label>
                </VBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Requested By -->
                <VBox spacing="5">
                    <Label text="Requested By">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="requestedByLabel" text="Employee Name">
                        <font>
                            <Font size="13"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                </VBox>

                <Separator>
                    <style>
                        -fx-background-color: #e0e0e0;
                    </style>
                </Separator>

                <!-- Request Date -->
                <VBox spacing="5">
                    <Label text="Request Date">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #757575;
                        </style>
                    </Label>
                    <Label fx:id="requestDateLabel" text="2024-01-15">
                        <font>
                            <Font size="13"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                </VBox>

            </VBox>

        </VBox>

    </GridPane>

    <!-- Items Section -->
    <VBox spacing="15" styleClass="content-card-modern">
        <padding>
            <Insets top="25" right="25" bottom="25" left="25"/>
        </padding>
        <style>
            -fx-background-color: white;
            -fx-background-radius: 15;
            -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.08), 12, 0, 0, 3);
        </style>

        <!-- Clean Items Section -->
        <VBox spacing="0" style="-fx-background-color: white; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.08), 12, 0, 0, 3); -fx-padding: 25;">
            <!-- Simple Header -->
            <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-padding: 0 0 20 0;">
                <VBox spacing="3" HBox.hgrow="ALWAYS">
                    <Label text="Requisition Items">
                        <font>
                            <Font name="System Bold" size="16"/>
                        </font>
                        <style>
                            -fx-text-fill: #2c3e50;
                        </style>
                    </Label>
                    <Label text="Build your order by selecting items from the filtered inventory">
                        <font>
                            <Font size="11"/>
                        </font>
                        <style>
                            -fx-text-fill: #6c757d;
                        </style>
                    </Label>
                </VBox>
                <Button fx:id="addItemButton"
                       text="+ Add Item"
                       onAction="#handleAddItem"
                       styleClass="action-button-secondary"
                       style="-fx-cursor: hand;">
                    <font>
                        <Font name="System Bold" size="12"/>
                    </font>
                </Button>
            </HBox>

            <!-- Enhanced Modern Table -->
            <TableView fx:id="itemsTable"
                      styleClass="modern-table"
                      prefHeight="400"
                      minHeight="400"
                      style="-fx-background-color: #ffffff; -fx-table-cell-border-color: #e5e7eb; -fx-border-color: #d1d5da; -fx-border-width: 1.5px; -fx-border-radius: 12px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 12, 0.0, 0, 3);">
                <columns>
                    <TableColumn fx:id="itemNameColumn"
                               text="Item Name"
                               prefWidth="250"
                               minWidth="200"
                               style="-fx-alignment: CENTER-LEFT;"/>

                    <TableColumn fx:id="categoryColumn"
                               text="Category"
                               prefWidth="150"
                               minWidth="120"
                               style="-fx-alignment: CENTER-LEFT;"/>

                    <TableColumn fx:id="quantityColumn"
                               text="Quantity"
                               prefWidth="100"
                               minWidth="80"
                               style="-fx-alignment: CENTER;"/>

                    <TableColumn fx:id="unitPriceColumn"
                               text="Unit Price (SAR)"
                               prefWidth="120"
                               minWidth="100"
                               style="-fx-alignment: CENTER-RIGHT;"/>

                    <TableColumn fx:id="subtotalColumn"
                               text="Subtotal (SAR)"
                               prefWidth="120"
                               minWidth="100"
                               style="-fx-alignment: CENTER-RIGHT;"/>

                    <TableColumn fx:id="actionsColumn"
                               text="Actions"
                               prefWidth="120"
                               minWidth="120"
                               style="-fx-alignment: CENTER;"/>
                </columns>

                <placeholder>
                    <VBox alignment="CENTER" spacing="15" style="-fx-padding: 60 20;">
                        <StackPane style="-fx-background-color: #f6f8fa; -fx-border-color: #d1d5da; -fx-border-width: 2; -fx-border-style: dashed; -fx-border-radius: 8; -fx-background-radius: 8;" prefWidth="80" prefHeight="80">
                            <Label text="ðŸ“‹" style="-fx-font-size: 36px; -fx-opacity: 0.5;"/>
                        </StackPane>
                        <VBox alignment="CENTER" spacing="5">
                            <Label text="No Items Added">
                                <font>
                                    <Font name="System Bold" size="15"/>
                                </font>
                                <style>
                                    -fx-text-fill: #2c3e50;
                                </style>
                            </Label>
                            <Label text="Click 'Add Item' to start building your requisition">
                                <font>
                                    <Font size="11"/>
                                </font>
                                <style>
                                    -fx-text-fill: #6c757d;
                                </style>
                            </Label>
                        </VBox>
                    </VBox>
                </placeholder>
            </TableView>
        </VBox>

    </VBox>

    <!-- Action Buttons -->
    <HBox spacing="15" alignment="CENTER_RIGHT">
        <Button fx:id="cancelButton"
               text="Cancel"
               styleClass="action-button-secondary"
               onAction="#handleCancel"
               prefWidth="120">
            <font>
                <Font size="13"/>
            </font>
            <padding>
                <Insets top="10" right="30" bottom="10" left="30"/>
            </padding>
            <style>
                -fx-background-radius: 10;
                -fx-border-radius: 10;
            </style>
        </Button>

        <Button fx:id="submitButton"
               text="Submit Request"
               styleClass="action-button-primary"
               onAction="#handleSubmit"
               prefWidth="150">
            <font>
                <Font size="13"/>
            </font>
            <padding>
                <Insets top="10" right="30" bottom="10" left="30"/>
            </padding>
            <style>
                -fx-background-radius: 10;
                -fx-border-radius: 10;
            </style>
        </Button>
    </HBox>

</VBox>

</ScrollPane>
