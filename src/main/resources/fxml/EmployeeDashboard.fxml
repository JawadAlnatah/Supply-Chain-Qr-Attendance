<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.Circle?>

<BorderPane fx:id="rootPane" xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.team.supplychain.controllers.EmployeeDashboardController"
            stylesheets="@../css/styles.css, @../css/dashboard-employee.css">

    <!-- =============================================== -->
    <!-- TOP: Modern Header Bar (NO SEARCH BAR)          -->
    <!-- =============================================== -->
    <top>
        <HBox styleClass="top-bar-modern" alignment="CENTER_LEFT" spacing="25">
            <padding>
                <Insets top="18" right="35" bottom="18" left="35"/>
            </padding>

            <!-- App Title & Subtitle -->
            <VBox spacing="2">
                <Label text="Employee Portal" styleClass="app-title-modern">
                    <font>
                        <Font name="System Bold" size="22.0" />
                    </font>
                </Label>
                <Label text="Track your attendance and manage requisitions" styleClass="app-subtitle">
                    <font>
                        <Font size="13.0" />
                    </font>
                </Label>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- Refresh Button -->
            <Button fx:id="refreshButton" styleClass="notification-icon" onAction="#handleRefreshDashboard"
                    style="-fx-background-color: transparent; -fx-cursor: hand; -fx-padding: 8 12;">
                <graphic>
                    <Label text="ðŸ”„" style="-fx-font-size: 18px;"/>
                </graphic>
            </Button>

            <!-- Notification Icon -->
            <StackPane styleClass="notification-icon">
                <Label text="ðŸ””" style="-fx-font-size: 18px;"/>
                <!-- Notification badge -->
                <Label text="3"
                       style="-fx-background-color: #43a047; -fx-text-fill: white; -fx-font-size: 10px;
                              -fx-padding: 2 5 2 5; -fx-background-radius: 10; -fx-translate-x: 12; -fx-translate-y: -10;"/>
            </StackPane>

            <!-- User Info Section -->
            <HBox spacing="15" alignment="CENTER">
                <VBox alignment="CENTER_RIGHT" spacing="2">
                    <Label text="Welcome back," styleClass="welcome-text-modern">
                        <font>
                            <Font size="12.0" />
                        </font>
                    </Label>
                    <Label fx:id="userNameLabel" text="Jawad Hassan" styleClass="role-text-modern">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- User Avatar -->
                <StackPane styleClass="user-avatar">
                    <Label text="ðŸ‘¤" styleClass="avatar-icon" style="-fx-font-size: 20px;"/>
                </StackPane>
            </HBox>

            <!-- Logout Button -->
            <Button fx:id="logoutButton" text="Logout" styleClass="logout-button-modern" onAction="#handleLogout">
                <font>
                    <Font name="System Bold" size="12.0" />
                </font>
            </Button>
        </HBox>
    </top>

    <!-- =============================================== -->
    <!-- LEFT: Sidebar Navigation                        -->
    <!-- =============================================== -->
    <left>
        <VBox styleClass="sidebar-modern" spacing="0" prefWidth="260">

            <!-- Logo Section -->
            <VBox styleClass="logo-section" alignment="CENTER" spacing="10">
                <padding>
                    <Insets top="25" right="20" bottom="25" left="20"/>
                </padding>
                <Label text="ðŸ¢" styleClass="logo-icon" style="-fx-font-size: 40px;"/>
                <Label text="SUPPLY CHAIN" styleClass="logo-text">
                    <font>
                        <Font name="System Bold" size="15.0" />
                    </font>
                </Label>
            </VBox>

            <!-- Menu Section -->
            <VBox spacing="5" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets top="20" right="15" bottom="20" left="15"/>
                </padding>

                <Label text="MAIN MENU" styleClass="menu-header-modern">
                    <padding>
                        <Insets top="0" right="0" bottom="10" left="10"/>
                    </padding>
                    <font>
                        <Font size="11.0" />
                    </font>
                </Label>

                <Region styleClass="menu-separator" prefHeight="1" maxHeight="1"/>

                <!-- Dashboard Button -->
                <Button fx:id="dashboardButton" styleClass="menu-button-modern" onAction="#handleDashboard" maxWidth="Infinity" alignment="CENTER_LEFT">
                    <graphic>
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <Label text="ðŸ " styleClass="menu-icon" style="-fx-font-size: 18px;"/>
                            <Label text="Dashboard">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                        </HBox>
                    </graphic>
                </Button>

                <!-- My Attendance Button -->
                <Button fx:id="attendanceButton" styleClass="menu-button-modern" onAction="#handleMyAttendance" maxWidth="Infinity" alignment="CENTER_LEFT">
                    <graphic>
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <Label text="ðŸ“…" styleClass="menu-icon" style="-fx-font-size: 18px;"/>
                            <Label text="My Attendance">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                        </HBox>
                    </graphic>
                </Button>

                <!-- My Requisitions Button -->
                <Button fx:id="requisitionsButton" styleClass="menu-button-modern" onAction="#handleMyRequisitions" maxWidth="Infinity" alignment="CENTER_LEFT">
                    <graphic>
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <Label text="ðŸ“‹" styleClass="menu-icon" style="-fx-font-size: 18px;"/>
                            <Label text="My Requisitions">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                        </HBox>
                    </graphic>
                </Button>

                <!-- Create Requisition Button -->
                <Button fx:id="createRequisitionButton" styleClass="menu-button-modern" onAction="#handleCreateRequisition" maxWidth="Infinity" alignment="CENTER_LEFT">
                    <graphic>
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <Label text="âž•" styleClass="menu-icon" style="-fx-font-size: 18px;"/>
                            <Label text="Create Requisition">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                        </HBox>
                    </graphic>
                </Button>

                <Region styleClass="menu-separator" prefHeight="1" maxHeight="1">
                    <VBox.margin>
                        <Insets top="10" bottom="10"/>
                    </VBox.margin>
                </Region>

                <Label text="ACCOUNT" styleClass="menu-header-modern">
                    <padding>
                        <Insets top="0" right="0" bottom="10" left="10"/>
                    </padding>
                    <font>
                        <Font size="11.0" />
                    </font>
                </Label>

                <!-- Profile Button -->
                <Button fx:id="profileButton" styleClass="menu-button-modern" onAction="#handleProfile" maxWidth="Infinity" alignment="CENTER_LEFT">
                    <graphic>
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <Label text="ðŸ‘¤" styleClass="menu-icon" style="-fx-font-size: 18px;"/>
                            <Label text="My Profile">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                        </HBox>
                    </graphic>
                </Button>

                <Region VBox.vgrow="ALWAYS"/>

                <!-- User Info Card -->
                <VBox styleClass="user-info-card" spacing="12" alignment="CENTER">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>

                    <StackPane styleClass="user-avatar-small">
                        <Label text="JH" style="-fx-text-fill: white; -fx-font-size: 16px;">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                    </StackPane>

                    <VBox spacing="3" alignment="CENTER">
                        <Label text="Jawad Hassan" styleClass="user-info-email">
                            <font>
                                <Font name="System Bold" size="12.0" />
                            </font>
                        </Label>
                        <Label text="Inventory Specialist" styleClass="user-info-email" style="-fx-font-size: 10px; -fx-opacity: 0.8;"/>
                        <Label text="â— Active" styleClass="user-status">
                            <font>
                                <Font size="10.0" />
                            </font>
                        </Label>
                    </VBox>
                </VBox>
            </VBox>
        </VBox>
    </left>

    <!-- =============================================== -->
    <!-- CENTER: Main Dashboard Content                  -->
    <!-- =============================================== -->
    <center>
        <ScrollPane fx:id="centerScrollPane" fitToWidth="true" fitToHeight="true" styleClass="content-area-modern">
            <VBox spacing="30" alignment="TOP_LEFT">
                <padding>
                    <Insets top="35" right="35" bottom="35" left="35"/>
                </padding>

                <!-- Welcome Section -->
                <VBox spacing="8">
                    <Label text="Good Morning, Jawad!" styleClass="welcome-message-modern">
                        <font>
                            <Font name="System Bold" size="28.0" />
                        </font>
                    </Label>
                    <Label fx:id="dateTimeLabel" text="Monday, November 25, 2025 â€¢ 9:30 AM" styleClass="subtitle-modern">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- ROW 1: Attendance Status Cards -->
                <HBox spacing="20" alignment="TOP_LEFT">

                    <!-- Today's Status Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" prefWidth="280" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>

                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <StackPane styleClass="stat-icon-blue">
                                <Label text="âœ“" styleClass="stat-icon-modern" style="-fx-font-size: 28px;"/>
                            </StackPane>
                            <VBox spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="TODAY'S STATUS" styleClass="stat-label-modern">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                                <Label fx:id="todayStatusLabel" text="Checked In" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="24.0" />
                                    </font>
                                </Label>
                                <Label text="at 8:15 AM" styleClass="stat-label-modern">
                                    <font>
                                        <Font size="12.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- This Week Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" prefWidth="280" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>

                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <StackPane styleClass="stat-icon-green">
                                <Label text="ðŸ“…" styleClass="stat-icon-modern" style="-fx-font-size: 28px;"/>
                            </StackPane>
                            <VBox spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="THIS WEEK" styleClass="stat-label-modern">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                                <Label fx:id="weekDaysLabel" text="3/5 Days" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="24.0" />
                                    </font>
                                </Label>
                                <HBox spacing="5" alignment="CENTER_LEFT">
                                    <Label text="â†‘" styleClass="stat-change-positive"/>
                                    <Label text="22.5 hours" styleClass="stat-change-positive">
                                        <font>
                                            <Font size="12.0" />
                                        </font>
                                    </Label>
                                </HBox>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- This Month Card -->
                    <VBox styleClass="stat-card-modern" spacing="15" prefWidth="280" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>

                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <StackPane styleClass="stat-icon-purple">
                                <Label text="ðŸ“Š" styleClass="stat-icon-modern" style="-fx-font-size: 28px;"/>
                            </StackPane>
                            <VBox spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="THIS MONTH" styleClass="stat-label-modern">
                                    <font>
                                        <Font size="11.0" />
                                    </font>
                                </Label>
                                <Label fx:id="monthDaysLabel" text="18/22 Days" styleClass="stat-value-modern">
                                    <font>
                                        <Font name="System Bold" size="24.0" />
                                    </font>
                                </Label>
                                <Label text="82% attendance" styleClass="stat-change-positive">
                                    <font>
                                        <Font size="12.0" />
                                    </font>
                                </Label>
                            </VBox>
                        </HBox>
                    </VBox>

                </HBox>

                <!-- ROW 2: Weekly Calendar & Quick Actions -->
                <HBox spacing="25" alignment="TOP_LEFT">

                    <!-- Weekly Calendar Card -->
                    <VBox styleClass="stat-card-modern" spacing="20" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="25" right="25" bottom="25" left="25"/>
                        </padding>

                        <Label text="This Week's Attendance" styleClass="section-title">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>

                        <!-- Dynamic Week Calendar Container -->
                        <HBox fx:id="weekCalendarContainer" spacing="12" alignment="CENTER" styleClass="week-calendar">
                        </HBox>

                        <HBox spacing="20" alignment="CENTER">
                            <HBox spacing="6" alignment="CENTER">
                                <Circle radius="6" style="-fx-fill: #43a047;"/>
                                <Label text="Present" style="-fx-text-fill: #757575; -fx-font-size: 11px;"/>
                            </HBox>
                            <HBox spacing="6" alignment="CENTER">
                                <Circle radius="6" style="-fx-fill: #2e7d32;"/>
                                <Label text="Today" style="-fx-text-fill: #757575; -fx-font-size: 11px;"/>
                            </HBox>
                            <HBox spacing="6" alignment="CENTER">
                                <Circle radius="6" style="-fx-fill: #e0e0e0;"/>
                                <Label text="Upcoming" style="-fx-text-fill: #757575; -fx-font-size: 11px;"/>
                            </HBox>
                        </HBox>
                    </VBox>

                    <!-- Quick Actions & Team Info Card -->
                    <VBox spacing="20" prefWidth="320">

                        <!-- Check In/Out Card -->
                        <VBox styleClass="stat-card-modern" spacing="15" alignment="CENTER">
                            <padding>
                                <Insets top="25" right="25" bottom="25" left="25"/>
                            </padding>

                            <StackPane>
                                <Circle radius="50" styleClass="status-circle, status-checked-in"/>
                                <Label text="âœ“" style="-fx-text-fill: white; -fx-font-size: 40px;"/>
                            </StackPane>

                            <Label text="You're Checked In" style="-fx-text-fill: #43a047; -fx-font-size: 16px;">
                                <font>
                                    <Font name="System Bold" size="16.0" />
                                </font>
                            </Label>

                            <VBox spacing="8" alignment="CENTER">
                                <HBox spacing="8" alignment="CENTER">
                                    <Label text="ðŸ•" style="-fx-font-size: 14px;"/>
                                    <Label text="Check-in: 8:15 AM" style="-fx-text-fill: #757575; -fx-font-size: 12px;"/>
                                </HBox>
                                <HBox spacing="8" alignment="CENTER">
                                    <Label text="â±" style="-fx-font-size: 14px;"/>
                                    <Label text="Hours: 6h 30m" style="-fx-text-fill: #757575; -fx-font-size: 12px;"/>
                                </HBox>
                            </VBox>

                            <Button text="Check Out" styleClass="action-button-primary" onAction="#handleCheckOut">
                                <font>
                                    <Font name="System Bold" size="13.0" />
                                </font>
                            </Button>
                        </VBox>

                        <!-- Team Status Card -->
                        <VBox styleClass="stat-card-modern" spacing="15" alignment="CENTER">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20"/>
                            </padding>

                            <Label text="Team Status" styleClass="section-title">
                                <font>
                                    <Font name="System Bold" size="14.0" />
                                </font>
                            </Label>

                            <VBox spacing="10" alignment="CENTER">
                                <Label text="ðŸ‘¥" style="-fx-font-size: 32px;"/>
                                <Label fx:id="teamOnSiteLabel" text="18" style="-fx-font-size: 28px; -fx-text-fill: #43a047;">
                                    <font>
                                        <Font name="System Bold" size="28.0" />
                                    </font>
                                </Label>
                                <Label text="Colleagues On-Site" style="-fx-text-fill: #757575; -fx-font-size: 12px;"/>
                            </VBox>

                            <VBox spacing="8" alignment="CENTER_LEFT" style="-fx-background-color: #e8f5e9; -fx-background-radius: 8; -fx-padding: 12;">
                                <HBox spacing="8" alignment="CENTER_LEFT">
                                    <Label text="ðŸ“¦" style="-fx-font-size: 14px;"/>
                                    <Label text="Warehouse Operations" style="-fx-text-fill: #2e7d32; -fx-font-size: 12px;">
                                        <font>
                                            <Font name="System Bold" size="12.0" />
                                        </font>
                                    </Label>
                                </HBox>
                                <HBox spacing="8" alignment="CENTER_LEFT">
                                    <Label text="ðŸ’¼" style="-fx-font-size: 14px;"/>
                                    <Label text="Inventory Specialist" style="-fx-text-fill: #424242; -fx-font-size: 11px;"/>
                                </HBox>
                            </VBox>
                        </VBox>
                    </VBox>

                </HBox>

                <!-- ROW 3: My Recent Requisitions -->
                <VBox styleClass="stat-card-modern" spacing="20">
                    <padding>
                        <Insets top="25" right="25" bottom="25" left="25"/>
                    </padding>

                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label text="My Recent Requisitions" styleClass="section-title">
                            <font>
                                <Font name="System Bold" size="18.0" />
                            </font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="+ New Requisition" styleClass="action-button-primary" onAction="#handleCreateRequisition">
                            <font>
                                <Font name="System Bold" size="12.0" />
                            </font>
                        </Button>
                    </HBox>

                    <!-- Requisition Items List (Dynamic) -->
                    <VBox fx:id="recentRequisitionsContainer" spacing="12">
                        <!-- Will be populated dynamically from controller -->
                        <Label text="Loading requisitions..." style="-fx-text-fill: #757575; -fx-font-size: 12px; -fx-padding: 20 0;"/>
                    </VBox>

                    <!-- View All Link -->
                    <HBox alignment="CENTER">
                        <Button text="View All Requisitions â†’" styleClass="action-button-secondary" onAction="#handleMyRequisitions">
                            <font>
                                <Font size="12.0" />
                            </font>
                        </Button>
                    </HBox>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- =============================================== -->
    <!-- BOTTOM: Status Bar                              -->
    <!-- =============================================== -->
    <bottom>
        <HBox styleClass="status-bar-modern" spacing="25" alignment="CENTER_LEFT">
            <padding>
                <Insets top="12" right="35" bottom="12" left="35"/>
            </padding>

            <HBox spacing="8" alignment="CENTER">
                <Label text="â—" styleClass="status-indicator"/>
                <Label text="System Operational" styleClass="status-text-modern">
                    <font>
                        <Font size="11.0" />
                    </font>
                </Label>
            </HBox>

            <Label text="|" style="-fx-text-fill: #e0e0e0;"/>

            <Label fx:id="currentDateLabel" text="November 25, 2025" styleClass="status-text-modern">
                <font>
                    <Font size="11.0" />
                </font>
            </Label>

            <Region HBox.hgrow="ALWAYS"/>

            <Label text="v1.0.0" styleClass="version-text">
                <font>
                    <Font size="10.0" />
                </font>
            </Label>

            <Label text="|" style="-fx-text-fill: #e0e0e0;"/>

            <Label text="Â© 2025 Supply Chain Management" styleClass="copyright-text-modern">
                <font>
                    <Font size="10.0" />
                </font>
            </Label>
        </HBox>
    </bottom>

</BorderPane>
