<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.team.supplychain.controllers.AdminDashboardController"
            styleClass="dashboard-root"
            stylesheets="@../css/dashboard-admin.css">

    <!-- TOP: Header Section -->
    <top>
        <HBox styleClass="dashboard-header" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>

            <Label text="Fresh Dairy Co." styleClass="dashboard-title"/>

            <Region HBox.hgrow="ALWAYS"/>

            <Label fx:id="currentUserLabel" text="Admin: Abdullah Ahmed" styleClass="user-label"/>
            <Button fx:id="settingsButton" text="âš™" styleClass="icon-button" onAction="#handleSettings"/>
            <Button fx:id="logoutButton" text="ðŸšª" styleClass="icon-button" onAction="#handleLogout"/>
        </HBox>
    </top>

    <!-- CENTER: Main Dashboard Content -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="dashboard-scroll">
            <VBox spacing="25" styleClass="dashboard-content">
                <padding>
                    <Insets top="30" right="30" bottom="30" left="30"/>
                </padding>

                <!-- ROW 1: Key Metrics Cards -->
                <HBox spacing="20" alignment="CENTER">
                    <!-- System Health Card -->
                    <VBox styleClass="dashboard-card, metric-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="System Health" styleClass="card-title"/>
                        <HBox alignment="CENTER" spacing="10">
                            <Label text="ðŸŸ¢" styleClass="metric-icon"/>
                            <Label text="OK" styleClass="metric-value, status-ok"/>
                        </HBox>
                        <Label text="All systems operational" styleClass="card-subtitle"/>
                    </VBox>

                    <!-- Active Users Card -->
                    <VBox styleClass="dashboard-card, metric-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="Active Users" styleClass="card-title"/>
                        <HBox alignment="CENTER" spacing="10">
                            <Label text="ðŸ‘¥" styleClass="metric-icon"/>
                            <Label fx:id="activeUsersLabel" text="24" styleClass="metric-value"/>
                        </HBox>
                        <Label text="Currently logged in" styleClass="card-subtitle"/>
                    </VBox>

                    <!-- Total Inventory Items Card -->
                    <VBox styleClass="dashboard-card, metric-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="Total Items" styleClass="card-title"/>
                        <HBox alignment="CENTER" spacing="10">
                            <Label text="ðŸ“¦" styleClass="metric-icon"/>
                            <Label fx:id="totalItemsLabel" text="342" styleClass="metric-value"/>
                        </HBox>
                        <Label text="In inventory" styleClass="card-subtitle"/>
                    </VBox>
                </HBox>

                <!-- ROW 2: Alert Cards -->
                <HBox spacing="20" alignment="CENTER">
                    <!-- Low Stock Alerts -->
                    <VBox styleClass="dashboard-card, alert-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="âš " styleClass="alert-icon, alert-warning"/>
                            <Label text="Low Stock Items" styleClass="card-title"/>
                        </HBox>
                        <Label fx:id="lowStockCountLabel" text="5" styleClass="alert-count, alert-warning"/>
                        <Label text="Items below reorder level" styleClass="card-subtitle"/>
                        <Button text="View Details" styleClass="card-action-button" onAction="#handleViewLowStock"/>
                    </VBox>

                    <!-- Security Incidents -->
                    <VBox styleClass="dashboard-card, alert-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="ðŸ”’" styleClass="alert-icon, alert-error"/>
                            <Label text="Security Incidents" styleClass="card-title"/>
                        </HBox>
                        <Label fx:id="securityIncidentsLabel" text="2" styleClass="alert-count, alert-error"/>
                        <Label text="Failed verification attempts" styleClass="card-subtitle"/>
                        <Button text="Review" styleClass="card-action-button" onAction="#handleReviewSecurity"/>
                    </VBox>

                    <!-- Pending Tasks -->
                    <VBox styleClass="dashboard-card, alert-card" spacing="10" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="ðŸ“‹" styleClass="alert-icon, alert-info"/>
                            <Label text="Pending Tasks" styleClass="card-title"/>
                        </HBox>
                        <Label fx:id="pendingTasksLabel" text="8" styleClass="alert-count, alert-info"/>
                        <Label text="Actions requiring attention" styleClass="card-subtitle"/>
                        <Button text="View All" styleClass="card-action-button" onAction="#handleViewTasks"/>
                    </VBox>
                </HBox>

                <!-- ROW 3: Charts and Details Section -->
                <HBox spacing="20" alignment="TOP_CENTER">
                    <!-- Inventory Value Trend Chart -->
                    <VBox styleClass="dashboard-card, chart-card" spacing="15" HBox.hgrow="ALWAYS" prefWidth="600">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="Inventory Value Trend (Last 30 Days)" styleClass="card-title"/>
                        <LineChart fx:id="inventoryTrendChart" legendVisible="false" animated="true">
                            <xAxis>
                                <CategoryAxis label="Date" side="BOTTOM"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Value (SAR)" side="LEFT"/>
                            </yAxis>
                        </LineChart>
                    </VBox>

                    <!-- Critical Alerts Panel -->
                    <VBox styleClass="dashboard-card, alerts-panel" spacing="15" prefWidth="350">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="Critical Alerts" styleClass="card-title"/>

                        <VBox fx:id="criticalAlertsContainer" spacing="10" styleClass="alerts-list">
                            <!-- Alert Item 1 -->
                            <HBox styleClass="alert-item, alert-item-warning" spacing="10" alignment="CENTER_LEFT">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>
                                <Label text="âš " styleClass="alert-item-icon"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Whole Milk - Low Stock" styleClass="alert-item-title"/>
                                    <Label text="Only 45 units remaining" styleClass="alert-item-description"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 2 -->
                            <HBox styleClass="alert-item, alert-item-error" spacing="10" alignment="CENTER_LEFT">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>
                                <Label text="ðŸ”´" styleClass="alert-item-icon"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Access Denied - Gate 1" styleClass="alert-item-title"/>
                                    <Label text="Employee #341 - 2 hours ago" styleClass="alert-item-description"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 3 -->
                            <HBox styleClass="alert-item, alert-item-info" spacing="10" alignment="CENTER_LEFT">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>
                                <Label text="â„¹" styleClass="alert-item-icon"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="PO #1247 Arriving Soon" styleClass="alert-item-title"/>
                                    <Label text="ETA: 15 minutes" styleClass="alert-item-description"/>
                                </VBox>
                            </HBox>

                            <!-- Alert Item 4 -->
                            <HBox styleClass="alert-item, alert-item-warning" spacing="10" alignment="CENTER_LEFT">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>
                                <Label text="âš " styleClass="alert-item-icon"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Greek Yogurt - Low Stock" styleClass="alert-item-title"/>
                                    <Label text="Only 28 units remaining" styleClass="alert-item-description"/>
                                </VBox>
                            </HBox>
                        </VBox>

                        <Button text="View All Alerts" styleClass="card-action-button-primary" onAction="#handleViewAllAlerts"/>
                    </VBox>
                </HBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- BOTTOM: Quick Action Bar -->
    <bottom>
        <HBox styleClass="dashboard-footer" spacing="15" alignment="CENTER">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>

            <Button text="ðŸ‘¥ Manage Users" styleClass="quick-action-button" onAction="#handleManageUsers"/>
            <Button text="ðŸ“¦ View Inventory" styleClass="quick-action-button" onAction="#handleViewInventory"/>
            <Button text="ðŸšš Purchase Orders" styleClass="quick-action-button" onAction="#handlePurchaseOrders"/>
            <Button text="ðŸ“Š Reports" styleClass="quick-action-button" onAction="#handleReports"/>
            <Button text="âš™ System Settings" styleClass="quick-action-button" onAction="#handleSystemSettings"/>
        </HBox>
    </bottom>

</BorderPane>
