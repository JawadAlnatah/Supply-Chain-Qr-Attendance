<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.team.supplychain.controllers.EmployeeAttendanceViewController"
      spacing="30" stylesheets="@../css/styles.css, @../css/dashboard-employee.css">
    <padding>
        <Insets top="35" right="35" bottom="35" left="35"/>
    </padding>

    <!-- Page Header -->
    <VBox spacing="8">
        <Label text="My Attendance" styleClass="page-title">
            <font>
                <Font name="System Bold" size="28"/>
            </font>
        </Label>
        <Label text="Track your attendance, check-in/out times, and view your attendance history" styleClass="page-subtitle" textFill="#808080">
            <font>
                <Font size="14"/>
            </font>
        </Label>
    </VBox>

    <!-- Summary Cards -->
    <HBox spacing="20" alignment="CENTER_LEFT">
        <!-- This Week Card -->
        <VBox styleClass="stat-card-modern" spacing="12" HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-green" prefWidth="45" prefHeight="45">
                    <Label text="ðŸ“…" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="This Week" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="weekAttendanceValue" text="4/5 Days" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>

        <!-- This Month Card -->
        <VBox styleClass="stat-card-modern" spacing="12" HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-green" prefWidth="45" prefHeight="45">
                    <Label text="ðŸ“Š" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="This Month" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="monthAttendanceValue" text="18/22 Days" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>

        <!-- Average Hours Card -->
        <VBox styleClass="stat-card-modern" spacing="12" HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <StackPane styleClass="stat-icon-green" prefWidth="45" prefHeight="45">
                    <Label text="â±ï¸" style="-fx-font-size: 22px;"/>
                </StackPane>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Avg. Daily Hours" styleClass="stat-label" textFill="#808080">
                        <font>
                            <Font size="13"/>
                        </font>
                    </Label>
                    <Label fx:id="avgHoursValue" text="7.8 hrs" styleClass="stat-value" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="22"/>
                        </font>
                    </Label>
                </VBox>
            </HBox>
        </VBox>
    </HBox>

    <!-- Calendar Toggle Section -->
    <VBox spacing="20" styleClass="content-card-modern">
        <padding>
            <Insets top="25" right="25" bottom="25" left="25"/>
        </padding>

        <!-- Toggle Buttons -->
        <HBox spacing="15" alignment="CENTER_LEFT">
            <Label text="View:" textFill="#2c3e50">
                <font>
                    <Font name="System Bold" size="14"/>
                </font>
            </Label>
            <Button fx:id="weeklyViewButton" text="Weekly" styleClass="action-button-primary" onAction="#handleWeeklyView">
                <font>
                    <Font size="13"/>
                </font>
                <padding>
                    <Insets top="10" right="20" bottom="10" left="20"/>
                </padding>
            </Button>
            <Button fx:id="monthlyViewButton" text="Monthly" styleClass="action-button-secondary" onAction="#handleMonthlyView">
                <font>
                    <Font size="13"/>
                </font>
                <padding>
                    <Insets top="10" right="20" bottom="10" left="20"/>
                </padding>
            </Button>
        </HBox>

        <!-- Calendar Container (StackPane for toggling) -->
        <StackPane>
            <!-- Weekly Calendar View (Dynamically Populated) -->
            <HBox fx:id="weeklyCalendarPane" spacing="15" alignment="CENTER">
            </HBox>

            <!-- Monthly Calendar View (Initially Hidden) -->
            <VBox fx:id="monthlyCalendarPane" spacing="15" visible="false" managed="false">
                <!-- Month Header -->
                <HBox alignment="CENTER" spacing="10">
                    <Button text="â—€" styleClass="action-button-secondary" onAction="#handlePreviousMonth">
                        <padding>
                            <Insets top="8" right="15" bottom="8" left="15"/>
                        </padding>
                    </Button>
                    <Label fx:id="monthLabel" text="December 2024" textFill="#2c3e50">
                        <font>
                            <Font name="System Bold" size="18"/>
                        </font>
                    </Label>
                    <Button text="â–¶" styleClass="action-button-secondary" onAction="#handleNextMonth">
                        <padding>
                            <Insets top="8" right="15" bottom="8" left="15"/>
                        </padding>
                    </Button>
                </HBox>

                <!-- Monthly Calendar Grid (Dynamically Populated) -->
                <GridPane fx:id="monthlyCalendarGrid" hgap="5" vgap="5">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                        <ColumnConstraints percentWidth="14.28" halignment="CENTER"/>
                    </columnConstraints>

                    <!-- Day Names (Header Row) -->
                    <Label text="SUN" styleClass="calendar-day-header" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label text="MON" styleClass="calendar-day-header" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                    <Label text="TUE" styleClass="calendar-day-header" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                    <Label text="WED" styleClass="calendar-day-header" GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                    <Label text="THU" styleClass="calendar-day-header" GridPane.columnIndex="4" GridPane.rowIndex="0"/>
                    <Label text="FRI" styleClass="calendar-day-header" GridPane.columnIndex="5" GridPane.rowIndex="0"/>
                    <Label text="SAT" styleClass="calendar-day-header" GridPane.columnIndex="6" GridPane.rowIndex="0"/>
                    <!-- Date cells will be dynamically generated by controller -->
                </GridPane>
            </VBox>
        </StackPane>
    </VBox>

    <!-- Attendance History Table -->
    <VBox spacing="15" styleClass="content-card-modern">
        <padding>
            <Insets top="25" right="25" bottom="25" left="25"/>
        </padding>

        <Label text="Attendance History" textFill="#2c3e50">
            <font>
                <Font name="System Bold" size="16"/>
            </font>
        </Label>

        <TableView fx:id="attendanceTable" styleClass="modern-table">
            <columns>
                <TableColumn text="Date" prefWidth="120" style="-fx-alignment: CENTER-LEFT;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="date"/>
                    </cellValueFactory>
                </TableColumn>
                <TableColumn text="Day" prefWidth="100" style="-fx-alignment: CENTER;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="day"/>
                    </cellValueFactory>
                </TableColumn>
                <TableColumn text="Check In" prefWidth="100" style="-fx-alignment: CENTER;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="checkIn"/>
                    </cellValueFactory>
                </TableColumn>
                <TableColumn text="Check Out" prefWidth="100" style="-fx-alignment: CENTER;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="checkOut"/>
                    </cellValueFactory>
                </TableColumn>
                <TableColumn text="Hours" prefWidth="80" style="-fx-alignment: CENTER;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="hours"/>
                    </cellValueFactory>
                </TableColumn>
                <TableColumn text="Status" prefWidth="120" style="-fx-alignment: CENTER;">
                    <cellValueFactory>
                        <javafx.scene.control.cell.PropertyValueFactory property="status"/>
                    </cellValueFactory>
                </TableColumn>
            </columns>
            <placeholder>
                <Label text="No attendance records found" textFill="#bdc3c7">
                    <font>
                        <Font size="14"/>
                    </font>
                </Label>
            </placeholder>
        </TableView>
    </VBox>

</VBox>
